<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <script src="./RecordRTC.js"></script>
    <script src="./DetectRTC.js"></script>
    <script src="./RecordingManager.js"></script>
    <script src="./record.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<style>
    .media-box video {
        width: 100%;
        vertical-align: top;
        object-fit: fill;
    }
    .media-box {
    background: black;
        width: 100%;
        vertical-align: top;
        object-fit: fill;
    }
    .top-item {
        hight: 50%;
        vertical-align: top;
        horiz-align: center;
    }
    .bottom-item {
        hight: 50%;
        vertical-align: bottom;
        horiz-align: center;
    }
    .coolbutton {
        background-color: #4CAF50; /* Green */
        border: none;
        color: black;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 8px;
        padding: 10px 24px;
    }
    @media screen and (min-width: 320px) and (max-width: 767px) and (orientation: landscape) {
        html {
            transform: rotate(-90deg);
            transform-origin: left top;
            width: 100vh;
            overflow-x: hidden;
            position: absolute;
            top: 100%;
            left: 0;
        }
    }

</style>

</head>
<body onload="loadConfig('./config.json')">
        <div id="recording-player"></div>
        <!--button onclick="StartMedia(eventId,'video-element',320)">StartVideo</--button>
        <button onclick="EndRecording(eventId)">End Recording</button-->
        <button class='coolbutton' onclick="increaseQuestionId();StartRecordingQuestion(eventId,questionId)">Start recording</button>
        <button class='coolbutton' onclick="StopRecordingQuestion(eventId,questionId)">Stop recording</button>
    </br>
    <video id="video-element"  width="320" height="240" ></video>
    </div>
    <hr style="border-top: 0;border-bottom: 1px solid rgb(189, 189, 189);margin: 4px -12px;margin-top: 8px;">

    <script>
        var ks='';
        var questionId = 0;
        function increaseQuestionId()
        {
            questionId++;
        }

        function bodyOnLoad()
        {
            const ret = screen.orientation.lock('portrait');
            ret.then();
            var eventId = Math.floor(Math.random() * 1000);
            var getQueryString = function ( field, url ) {
                var href = url ? url : window.location.href;
                var reg = new RegExp( '[?&]' + field + '=([^&#]*)', 'i' );
                var string = reg.exec(href);
                return string ? string[1] : null;
            };
            ks = getQueryString('ks');
            console.log("KS is - " + ks);

            setKs(ks);
            const width = getMobileWidth();
            printDebug("orientation is -"+ window.orientation + " " + getOrientation() + " x * y  is -" + getMobileWidth() + " " + getMobileHeight());
            StartMedia(eventId,'video-element',width*0.7);

        }

        function loadConfig(configFileUrl) {
            $(document).ready(function()
            {
                $.getJSON(configFileUrl, function(result){
                    console.log(result);
                    setConfig(result);
                    bodyOnLoad();
                });
            });

        }


        function getOrientation(){
            if(window.orientation==0)
            {
                return "portrait";
            }
            return "landscape";
        };
        function getMobileWidth(){
            return getOrientation() == "landscape" ? screen.availWidth : screen.availHeight;
        };
        function getMobileHeight(){
            return getOrientation() == "landscape" ? screen.availHeight : screen.availWidth;
        };

    </script>

</body>
</html>
